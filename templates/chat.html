{% extends "layout.html" %}

{% block content %}
<div class="chat-wrapper">
      <div class="image-container"></div>
   <div class="friends-list">
    <h4>Danh sách bạn bè</h4>

    <!-- Ô tìm kiếm -->
    <input type="text" id="search-friend" class="form-control" placeholder="Tìm kiếm bạn bè...">

    <ul class="list-group" id="friends-container">
        {% for user in users %}
            <li class="friend-item" onclick="setReceiver({{ user.id }}, '{{ user.username }}')">
                <div class="avatar"></div>
                <span class="friend-name">{{ user.username }}</span>
                <span class="status online"></span>
            </li>
        {% endfor %}
    </ul>
</div>


    <!-- Hộp chat -->
    <div class="chat-container hidden">
        <div class="chat-header">
            <h5 id="chat-title">Chọn một người để chat</h5>
        </div>
       <div id="chat-box" class="chat-box">
    {% for message in messages %}
        <div class="chat-message
            {% if message.sender_id == current_user.id %}sent{% else %}received{% endif %}"
            data-sender="{{ message.sender_id }}"
            data-receiver="{{ message.receiver_id }}">
            <strong>{{ message.username }}:</strong> {{ message.message }}
            <small class="timestamp">{{ message.sent_at }}</small>
        </div>
    {% endfor %}
</div>


        <!-- Form gửi tin nhắn -->
        <form method="POST" action="{{ url_for('chat') }}" class="chat-input">
            <input type="hidden" id="receiver_id" name="receiver_id" required>
            <input type="text" id="message" name="message" class="form-control" placeholder="Nhập tin nhắn..." required>
            <button type="submit" class="send-btn"><i class="fas fa-paper-plane"></i>Gửi</button>
        </form>
    </div>
</div>


<script src="{{ url_for('static', filename='js/chat.js') }}"></script>

{% endblock %}
